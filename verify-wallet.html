<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wallet Key Verification</title>
    <script src="https://cdn.jsdelivr.net/npm/@solana/web3.js@1.87.6/lib/index.iife.min.js"></script>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1a1a1a;
            color: #00ff00;
        }
        .result {
            background: #000;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #00ff00;
        }
        .error {
            color: #ff0000;
        }
        .success {
            color: #00ff00;
        }
        .warning {
            color: #ffff00;
        }
        button {
            background: #00ff00;
            color: #000;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            font-family: monospace;
            font-weight: bold;
        }
        button:hover {
            background: #00cc00;
        }
        input {
            background: #000;
            color: #00ff00;
            border: 1px solid #00ff00;
            padding: 5px;
            font-family: monospace;
            margin: 5px;
            width: 600px;
        }
    </style>
</head>
<body>
    <h1>ðŸ”‘ Wallet Key Verification Tool</h1>
    
    <div>
        <h3>Step 1: Enter Private Key</h3>
        <input type="text" id="privateKey" placeholder="Enter private key..." value="2R2QJtB4gAY9qtaooui8ngRFNTbVHo88j9zHUzAUuUZrhrpHX2JWpZ4cCyjkhmkFJYwgfQHXjen27GHJDJnUf7T8">
        <button onclick="verifyKey()">Verify Private Key</button>
    </div>
    
    <div>
        <h3>Step 2: Check Expected Address</h3>
        <input type="text" id="expectedAddress" placeholder="Expected wallet address..." value="6VP9v3EqHZgn5Qudx2Kw9ZZqQxsPu43hVT7UVe8xtest">
        <button onclick="checkMatch()">Check Match</button>
    </div>
    
    <div>
        <h3>Step 3: Check SOL Balance</h3>
        <button onclick="checkBalance()">Check SOL Balance</button>
    </div>
    
    <div class="result" id="output"></div>

    <script>
        let derivedPublicKey = null;
        
        function log(message, type = 'info') {
            const output = document.getElementById('output');
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : type === 'warning' ? 'warning' : 'info';
            output.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
            output.scrollTop = output.scrollHeight;
        }
        
        function verifyKey() {
            const privateKey = document.getElementById('privateKey').value.trim();
            
            if (!privateKey) {
                log('Please enter a private key', 'error');
                return;
            }
            
            try {
                // Decode base58 private key manually
                const bs58 = '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz';
                const base58ToBytes = (str) => {
                    const bytes = [];
                    for (let i = 0; i < str.length; i++) {
                        let carry = bs58.indexOf(str[i]);
                        if (carry < 0) throw new Error('Invalid base58 character');
                        for (let j = 0; j < bytes.length; j++) {
                            carry += bytes[j] * 58;
                            bytes[j] = carry & 0xff;
                            carry >>= 8;
                        }
                        while (carry > 0) {
                            bytes.push(carry & 0xff);
                            carry >>= 8;
                        }
                    }
                    // Add leading zeros
                    for (let i = 0; i < str.length && str[i] === '1'; i++) {
                        bytes.push(0);
                    }
                    return new Uint8Array(bytes.reverse());
                };
                
                const secretKey = base58ToBytes(privateKey);
                const keypair = window.solanaWeb3.Keypair.fromSecretKey(secretKey);
                derivedPublicKey = keypair.publicKey.toString();
                
                log('âœ… Private key is valid!', 'success');
                log(`ðŸ”‘ Derived Public Key: ${derivedPublicKey}`, 'info');
                log(`ðŸ”‘ Private Key: ${privateKey.substring(0, 20)}...`, 'info');
                
            } catch (error) {
                log(`âŒ Invalid private key: ${error.message}`, 'error');
                derivedPublicKey = null;
            }
        }
        
        function checkMatch() {
            const expectedAddress = document.getElementById('expectedAddress').value.trim();
            
            if (!derivedPublicKey) {
                log('Please verify the private key first', 'error');
                return;
            }
            
            if (!expectedAddress) {
                log('Please enter expected address', 'error');
                return;
            }
            
            log(`Expected: ${expectedAddress}`, 'info');
            log(`Derived:  ${derivedPublicKey}`, 'info');
            
            if (derivedPublicKey === expectedAddress) {
                log('âœ… PERFECT MATCH! Keys are correct!', 'success');
                log('ðŸŽ‰ This private key generates the expected wallet address', 'success');
            } else {
                log('âŒ MISMATCH! Keys do not match!', 'error');
                log('âš ï¸ The private key generates a different wallet address', 'warning');
                log('ðŸ’¡ You need the private key for the expected address', 'info');
                log('ðŸ” Check your wallet backup for the correct private key', 'info');
            }
        }
        
        async function checkBalance() {
            if (!derivedPublicKey) {
                log('Please verify the private key first', 'error');
                return;
            }
            
            try {
                const connection = new window.solanaWeb3.Connection(
                    'https://mainnet.helius-rpc.com/?api-key=a22943bd-77f2-4e3c-a8d0-3b73d2afc326',
                    'confirmed'
                );
                
                log('ðŸ” Checking SOL balance...', 'info');
                const balance = await connection.getBalance(derivedPublicKey);
                const balanceInSol = balance / 1e9;
                
                log(`ðŸ’° SOL Balance: ${balanceInSol} SOL`, 'success');
                log(`ðŸ“ Wallet: ${derivedPublicKey}`, 'info');
                
                if (balanceInSol > 0) {
                    log('âœ… This wallet has SOL for transaction fees!', 'success');
                } else {
                    log('âŒ This wallet has 0 SOL - cannot process withdrawals', 'error');
                    log('ðŸ’¡ Send 0.01 SOL to this address to enable withdrawals', 'info');
                }
                
            } catch (error) {
                log(`âŒ Balance check failed: ${error.message}`, 'error');
            }
        }
        
        // Auto-verify on load
        window.addEventListener('load', () => {
            log('ðŸš€ Wallet Verification Tool Loaded', 'success');
            log('ðŸ‘† Click "Verify Private Key" to start', 'info');
        });
    </script>
</body>
</html>
